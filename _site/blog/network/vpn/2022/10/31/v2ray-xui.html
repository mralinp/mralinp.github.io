<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="4-8jdtFeOSWDhx6RjXrSwNrvhvLyFdbACncYtB2Rjzc" />
    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="mralinp" />
    <title> Bypass The Islamic Republic Again: Installing V2ray + XUI </title>

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <!-- Our Custom CSS -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.css">
    <!-- Font awesome -->
    <script src="https://kit.fontawesome.com/40a6ec6105.js" crossorigin="anonymous"></script>
    <!-- Prism CSS -->
    <link rel="stylesheet" href="/assets/css/prism.css">
    <!-- Prism JS -->
    <script src="/assets/js/prism.js"></script>
</head>

<body>
    <div class="wrapper">
        <!-- Sidebar  -->
        <nav id="sidebar">
            <div class="sidebar-header">
                <h3><a href="/">Ali N. Parizi</a></h3>
            </div>

            <ul class="list-unstyled components">
                <li class="sidebar-item">
                    <a href="/"><i class="fa fa-home" aria-hidden="true"></i> Home</a>
                </li>
                <li class="sidebar-item">
                    <a href="/blog"><i class="fa fa-rss" aria-hidden="true"></i> Blog</a>
                </li>
                <li class="sidebar-item">
                    <a href="/projects"><i class="fa fa-flask" aria-hidden="true"></i> Projects</a>
                </li>
                <li class="sidebar-item">
                    <a href="/library"><i class="fa fa-book" aria-hidden="true"></i> Library</a>
                </li>
                <li class="sidebar-item">
                    <a href="/about"><i class="fa fa-info" aria-hidden="true"></i> About me</a>
                </li>
            </ul>

            <ul class="list-unstyled CTAs">
                <li class="sidebar-btn">
                    <a href="https://github.com/mralinp"> <i class="fab fa-github"></i> Github profile
                    </a>
                </li>
                <li class="sidebar-btn">
                    <a href="/assets/resume/ali-naderi-parizi-cv.pdf"> <i class="fas fa-file"></i> Download resume</a>
                </li>
            </ul>
            <footer class="footer" style="text-align: center;">
                <div class="container">
                    <span class="text-muted">Powered by <br> <i class="fab fa-github"></i> Github</span>
                </div>
            </footer>
        </nav>

        <!-- Page Content  -->
        <div id="content">
            <!-- Navbar -->
            <nav class="navbar navbar-expand-lg">
                <div class="container-fluid">
                    <a class="navbar-brand" href="/" id="brand">Ali N. Parizi</a>
                    <button type="button" id="sidebarCollapse" class="btn btn-info">
                        <i class="fas fa-align-left"></i>
                        <span>Menu</span>
                    </button>
                    <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <i class="fas fa-align-justify"></i>
                    </button>

                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="nav navbar-nav mr-auto" id="navbarLinks">
                            <li class="nav-item active">
                                <a class="nav-link" href="/">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/assets/resume/ali-naderi-parizi-cv.pdf">Resume</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/blog">Blog</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/about">About me</a>
                            </li>
                        </ul>
                        <form class="form-inline ml-auto" method="get" action="http://www.google.com/search" target="_blank">
                            <input type="hidden" name="sitesearch" value="alinaderiparizi.com" />
                            <input class="form-control mr-sm-2" type="text" name="q" maxlength="255" placeholder="Search" />
                            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
                        </form>
                    </div>
                </div>
            </nav>
            <div class="container">
                <article>
    <div class="image-wrapper text-center">
        <a class="image-zoom cboxElement" href="">
        <img src="/assets/images/projects/v2ray/title.png" class="rounded mx-auto" width="100%"  alt="Photo of Blog">
        <div class="image-overlay"></div> 
        </a>
    </div>
    <br>
    <div class="post-content">
        <h2>Bypass The Islamic Republic Again: Installing V2ray + XUI</h2>
        <ul class="post-meta list-inline">
            <li class="list-inline-item">
                <i class="fa fa-user-circle-o"></i> Ali N. Parizi
            </li>
            <li class="list-inline-item">
                <i class="fa fa-calendar-o"></i> 31 October 2022
            </li>
            <li class="list-inline-item">
                <i class="fa fa-tags"></i>
                    <span class="category">
                    blog
                    </span>
                    
                         <span class="category">
                         network
                         </span>
                    
                         <span class="category">
                         vpn
                         </span>
                    
            </li>
        </ul>
        <p class="text-secondary"> When the situation is challenging, UDP-based VPN protocols might not work and we have to use something else to be able to bypass this madness. This tutorial is about installing and configuring the popular Chinese VPN protocol V2Ray on a ubuntu server using a web-based control panel called X-UI. <p>
        <div class="line"></div>
        <h1 id="1-intro">1. Intro</h1>
<p>Last time, I wrote an article about bypassing God’s government restrictions to be able to access the outside world. Now the base solution still stands, but the protocol we used to implement that solution no longer works. We can clap our hands to the government priests for upgrading their knowledge about VPN protocols and say bravo in chinese “<a href="https://translate.google.com/?sl=zh-CN&amp;tl=en&amp;text=%E9%AB%98%E4%B8%9D%E7%BA%B3%E7%BA%B3%E9%A1%BF&amp;op=translate" title="Kose na na ton!">高丝纳纳顿</a>”.</p>

<p>As our government and Chinese folks are each other’s besties and in the same bed! we can conclude that any protocol that works on the great firewall of china, should work for the evils firewall of the Islamic Republic!</p>

<p>V2Ray is a VPN protocol written with love by some free Chinese people. It works on the application layer and its traffic looks like working with an actual web-site and it’s less prone to detect. The problem with V2Ray is the english language support, documentations and weak client software which can easily be improved if their community decided to share their information and issues in english not in fucking chinees!</p>

<p>For this article we consider you have access to a Virtual Machine in the outside world. You can access that machine using SSH or you can easily install a cockpit to be able to access your Linux machine through the browser.</p>

<h2 id="11-installing-cockpit-optional">1.1 Installing Cockpit (Optional)</h2>
<p>To install Cockpit, connect to your machine using ssh and use the aptitude package manager to install cockpit:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>apt update <span class="nt">--yes</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>apt upgrade <span class="nt">--yes</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>apt <span class="nb">install </span>cockpit <span class="nt">--yes</span>
</code></pre></div></div>

<p>This should install the cockpit and dose all the configurations for you. The cockpit is a web-based control panel and it will run on port 9090 of the server so, you have to allow connecting this port if your firewall is enabled:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>ufw allow 9090
<span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>ufw disable
<span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>ufw <span class="nb">enable</span>
</code></pre></div></div>

<p>Then open a browser and type the address <code class="language-plaintext highlighter-rouge">YOUR_VM_IP:9090</code> to see the cockpit panel.
Username and password of cockpit panel are the same as your vm user for example:</p>

<pre><code class="language-txt">username: root
password: 123456
</code></pre>

<p align="center">
    <img width="80%" src="/assets/images/projects/v2ray/cockpit.png" />
</p>

<h1 id="2-installing-v2ray-using-x-ui">2. Installing V2ray using X-UI</h1>
<p>To install V2ray you can easily install X-UI panel on your machine and this will automatically install all necessary things for you. X-UI documentation could be found here: <a href="https://seakfind.github.io/2021/10/10/X-UI/"><strong>seakfind</strong></a></p>

<p>The installation process is pretty easy, just connect to your machine and install <code class="language-plaintext highlighter-rouge">socat</code> first:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>apt <span class="nb">install </span>curl socat <span class="nt">-y</span>
</code></pre></div></div>

<p>Then you can skip obtaining certificate steps and directly jump on installing the x-ui using its script:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>bash &lt;<span class="o">(</span>curl <span class="nt">-Ls</span> https://raw.githubusercontent.com/vaxilu/x-ui/master/install.sh<span class="o">)</span>
</code></pre></div></div>
<p>Then it will ask you to type <code class="language-plaintext highlighter-rouge">yes|no</code>, you type yes and press enter on any chinese message prompt it shows to you. That’s it, you can start  the panel by typing:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>x-ui start
</code></pre></div></div>

<p>It starts the X-UI panel on the port <code class="language-plaintext highlighter-rouge">54321</code> of server. Open a browser and type <code class="language-plaintext highlighter-rouge">YOUR_VM_IP:54321</code> in the address bar to see the panel. Default username and password are:</p>

<pre><code class="language-txt">username: admin
password: admin
</code></pre>

<p align="center">
    <img width="80%" src="/assets/images/projects/v2ray/xui.png" />
</p>

<p>Default language of x-ui is chaines, i use Google chrome and Google translate to translate its contexts to english and i recommend you to do so.</p>

<p>After login, you have to go and change the default username and password of the panel (You can change the default port as well). From the sidebar panel select the third option, then select the second tab. Now type the old username and password on first two fields the new ones on the next two. Press <code class="language-plaintext highlighter-rouge">Revise</code> to save the changes.</p>

<p align="center">
    <img width="80%" src="/assets/images/projects/v2ray/x-ui-1.png" />
</p>

<p>Now go to inbound list from the sidebar and press add for creating a new VPN configuration. For example you can select VMess or VLess protocol under Websocket(ws) as you can see on the picture below. If you choose VLess be aware of that VLess has no encryption and VMess is a better choice.</p>

<blockquote>
  <p>Note: You can go and search for other V2Ray configurations but VMess is good enough for our article.</p>
</blockquote>

<p align="center">
    <img width="80%" src="/assets/images/projects/v2ray/xui-u.png" />
</p>

<p>Now, you are all set, you can scan the QR code or press copy share link to copy the share link to the clip board and send it to your clients.</p>

<p align="center">
    <img width="80%" src="/assets/images/projects/v2ray/x-ui-2.png" />
</p>

<h1 id="3-clients-setup-for-using-v2ray">3. Clients setup for using V2Ray</h1>
<p>To connect to the V2Ray server you have to install the proper client application on your devices. Here is a list of application clients for different devices and operating systems:</p>

<ul>
  <li><strong>Android</strong>: <a href="https://play.google.com/store/apps/details?id=com.v2ray.ang">V2rayNG (Google play)</a></li>
  <li><strong>IOS</strong>: <a href="https://apps.apple.com/us/app/napsternetv/id1629465476">NapsternetV (App Store)</a></li>
  <li><strong>Windows</strong>: <a href="https://github.com/Qv2ray/Qv2ray/releases/download/v2.7.0/Qv2ray-v2.7.0-Windows-Installer.exe">Qv2ray-v2.7.0-Windows-Installer.exe</a></li>
  <li><strong>Mac OSX</strong>: <a href="https://github.com/Qv2ray/Qv2ray/releases/download/v2.7.0/Qv2ray-v2.7.0-macOS-x64.dmg">Qv2ray-v2.7.0-macOS-x64.dmg</a></li>
  <li><strong>Linux</strong>: <a href="https://github.com/Qv2ray/Qv2ray/releases/download/v2.7.0/Qv2ray-v2.7.0-linux-x64.AppImage">Qv2ray-v2.7.0-linux-x64.AppImage</a></li>
</ul>

<h1 id="4-using-tls-optional-but-recommended">4. Using TLS (Optional but, recommended.)</h1>

<p>To make the clients connection more secure and safer, we need to use TLS on our server.</p>
<h2 id="41-what-is-transport-layer-security-tls">4.1 What is Transport Layer Security (TLS)?</h2>

<p>Transport Layer Security, or TLS, is a widely adopted security protocol designed to facilitate privacy and data security for communications over the Internet. A primary use case of TLS is encrypting the communication between web applications and servers, such as web browsers loading a website. TLS can also be used to encrypt other communications such as email, messaging, and voice over IP (VoIP). In this article we will focus on the role of TLS in web application security.</p>

<p>TLS was proposed by the Internet Engineering Task Force (IETF), an international standards organization, and the first version of the protocol was published in 1999. The most recent version is TLS 1.3, which was published in 2018.</p>

<h1 id="42-buy-a-domain">4.2 Buy a domain</h1>

<h1 id="43-generating-a-new-certificate-using-cert-bot">4.3 Generating a new certificate using <code class="language-plaintext highlighter-rouge">cert-bot</code></h1>

<h1 id="45-activating-cdn-optional-but-recommended">4.5 Activating CDN (Optional but recommended)</h1>

<h1 id="references">References</h1>
<ul>
  <li><a href="https://seakfind.github.io/2021/10/10/X-UI/">https://seakfind.github.io/2021/10/10/X-UI/</a></li>
</ul>


    </div>
    <div class="commentbox"></div>
    <script src="https://unpkg.com/commentbox.io/dist/commentBox.min.js"></script>
    <script>
        function arrToHex(arr) {
            let s = '#';
            for (let i = 0; i < arr.length; i++) {
                s += ((arr[i] / 16) | 0).toString(16);
                s += ((arr[i] % 16) | 0).toString(16);
            }
            return s;
        }
        var element = document.body;
        var style;
        var color = "black";
        if (window.getComputedStyle) {
            style = window.getComputedStyle(element);
        } else {
            style = element.currentStyle;
        }
        if (!style) {
            // ...seriously old browser...
        } else {
            color = style.color;
        }
        rgb = color.match(/\d+/g);
        commentBox('5649421849067520-proj', {
            textColor: arrToHex(rgb),
        })
    </script>
</article>

            </div>
        </div>
    </div>

    
    

    <!-- jQuery CDN - Slim version (=without AJAX) -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous">
    </script>
    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous">
    </script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous">
    </script>
    <!-- jQuery Custom Scroller CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.concat.min.js">
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            $("#sidebar").mCustomScrollbar({
                theme: "minimal"
            });

            $('#sidebarCollapse').on('click', function() {
                $('#sidebar, #content').toggleClass('active');
                $('.collapse.in').toggleClass('in');
                $('a[aria-expanded=true]').attr('aria-expanded', 'false');
            });
        });
    </script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML">
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']], processEscapes: true}, jax: ["input/TeX","input/MathML","input/AsciiMath","output/CommonHTML"], extensions: ["tex2jax.js","mml2jax.js","asciimath2jax.js","MathMenu.js","MathZoom.js","AssistiveMML.js",
        "[Contrib]/a11y/accessibility-menu.js"], TeX: { extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"], equationNumbers: { autoNumber: "AMS" } } });
    </script>
    <script src="/assets/js/main.js" crossorigin="anonymous"></script>
</body>

</html>